<!DOCTYPE html>
<html>
  <head>
  <meta charset='UTF-8'>
  <title>Ghost.js Documentation</title>
  <script src='../javascript/application.js'></script>
  <script src='../javascript/search.js'></script>
  <link rel='stylesheet' href='../stylesheets/application.css' type='text/css'>
</head>
  <body>
    <div id='base' data-path='../'></div>
<div id='header'>
  <div id='menu'>
    <a href='../extra/README.md.html' title='Ghost.js'>
      Ghost.js
    </a>
    &raquo;
    <a href='../alphabetical_index.html' title='Index'>
      Index
    </a>
    &raquo;
    <span class='title'>README.md</span>
  </div>
</div>
    <div id='content'>
      <nav class='toc'>
        <p class='title'>
          <a class='hide_toc' href='#'>
            <strong>Table of Contents</strong>
          </a>
          <small>
            (<a class='float_toc' href='#'>left</a>)
          </small>
        </p>
      </nav>
      <div id='filecontents'>
        <h1 id="shioriloader">ShioriLoader</h1><p>伺かの栞サブシステムをロードします。</p><h2 id="-">使用方法</h2>
<pre><code>&lt;script src=&quot;ShioriLoader.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;shioridetector-common_names.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;kawariworker.js&quot;&gt;&lt;/script&gt;

ShioriLoader.shiori_detectors.push(function(){...}); // 追加の栞判定関数登録
ShioriLoader.shiori_detectors.push(function(){...});
// shioridetector-common_names.jsなど栞判定関数ライブラリを読み込めば自動的に登録されている。

ShioriLoader.shiories.myshiori = function(){...}; // 追加の栞クラス登録
ShioriLoader.shiories.satori = function(){...};
// など栞ライブラリを読み込めば自動的に登録されている。

ShioriLoader.detect_shiori().then(function(shiori){
  shiori.load(dirpath).then(...);
}, function(error){
  throw error;
});
</code></pre><p>やりとりをすべて非同期で行うため、すべてのメソッドは<code>Promise</code>を返します。</p><h2 id="class-shioriloader">class ShioriLoader</h2><p>栞サブシステムをロードするSingletonクラスです。</p><h3 id="-array-shioridetector-shiori_detectors-static-"><code>Array&lt;ShioriDetector&gt;</code> shiori_detectors <em>static</em></h3>
<pre><code>ShioriLoader.shiori_detectors.push(function(){...});
</code></pre><p>栞判定関数の配列です。</p><h3 id="-object-string-class-shiori-shiories-static-"><code>Object&lt;string, class Shiori&gt;</code> shiories <em>static</em></h3>
<pre><code>ShioriLoader.shiories.myshiori = myshiori_class;
</code></pre><p>栞名と栞クラスの連想配列です。</p><h3 id="-promise-shiori-detect_shiori-filesystemlike-fs-string-dirpath-static-"><code>Promise&lt;Shiori&gt;</code> detect_shiori(<code>FileSystemLike</code> fs, <code>string</code> dirpath) <em>static</em></h3>
<pre><code>var dirpath = &#39;./ikagaka/ghost/myghost/ghost/master/&#39;;
ShioriLoader.detect_shiori(fs, dirpath).then(function(shiori){
  shiori.load(dirpath).then(...);
}, function(error){
  throw error;
});
</code></pre><ul>
<li>fs: node.jsのFile Systemか、BrowserFSのファイルシステム。</li>
<li>dirpath: SHIORI/2.x, SHIORI/3.x <code>load()</code>に渡されるものと同じ<code>ghost/master</code>へのフルパス。末尾は必ずパスセパレータ(<code>\</code>,<code>/</code>等 環境依存)。</li>
</ul><p>登録された栞判定関数を順番に実行します。</p><p>栞判定関数が返した栞インスタンスを返します。</p><p>栞判定関数が<code>null</code>を返せば次の栞判定関数を実行します。</p><p>すべての栞判定関数が栞インスタンスを返さなければ例外を発生します。</p><h3 id="-promise-shiori-get_shiori-filesystemlike-fs-string-shiori_name-static-"><code>Promise&lt;Shiori&gt;</code> get_shiori(<code>FileSystemLike</code> fs, <code>string</code> shiori_name) <em>static</em></h3>
<pre><code>var dirpath = &#39;./ikagaka/ghost/myghost/ghost/master/&#39;;
ShioriLoader.get_shiori(fs, &#39;kawari&#39;).then(function(shiori){
  shiori.load(dirpath).then(...);
}, function(error){
  throw error;
});
</code></pre><ul>
<li>fs: node.jsのFile Systemか、BrowserFSのファイルシステム。</li>
<li>shiori_name: shioriesに登録された栞名</li>
</ul><p>指定された栞のインスタンスを返します。</p><p>失敗すれば例外を発生します。</p><h2 id="interface-shiori">interface Shiori</h2><p>SHIORI/2.x, SHIORI/3.x規格に準拠した栞サブシステムのインターフェースです。</p><p>登録される栞は以下のAPIに準拠するべきです。</p><h3 id="constructor-filesystemlike-fs-">constructor(<code>FileSystemLike</code> fs)</h3>
<ul>
<li>fs: node.jsのFile Systemか、BrowserFSのファイルシステム。</li>
</ul><p>ゴーストのファイルを扱うインターフェースとしてfsが渡されます。</p><p>node.jsである場合とbrowserfsである場合があります。</p><h3 id="-promise-int-load-string-dirpath-"><code>Promise&lt;int&gt;</code> load(<code>string</code> dirpath)</h3>
<ul>
<li>dirpath: SHIORI/2.x, SHIORI/3.x <code>load()</code>に渡されるものと同じ<code>ghost/master</code>へのフルパス。末尾は必ずパスセパレータ(<code>\</code>,<code>/</code>等 環境依存)。</li>
</ul><p>SHIORI/2.x, SHIORI/3.x <code>load()</code>です。</p><p><code>load()</code>の戻り値を返してください。</p><h3 id="-promise-string-request-string-request-"><code>Promise&lt;string&gt;</code> request(<code>string</code> request)</h3>
<ul>
<li>dirpath: SHIORI/2.x, SHIORI/3.x <code>request()</code>に渡されるものと同じSHIORI/2.x, SHIORI/3.x Request。</li>
</ul><p>SHIORI/2.x, SHIORI/3.x <code>request()</code>です。</p><p>SHIORI/2.x, SHIORI/3.x Responseを返してください。</p><h3 id="-promise-int-unload-"><code>Promise&lt;int&gt;</code> unload()</h3><p>SHIORI/2.x, SHIORI/3.x <code>unload()</code>です。</p><p><code>unload()</code>の戻り値を返してください。</p><h2 id="interface-shioridetector">interface ShioriDetector</h2><p>栞を判定し、ロードする関数のインターフェースです。</p><p>登録される栞判定関数は以下のAPIに準拠するべきです。</p><h3 id="-promise-shiori-null-function-filesystemlike-fs-string-dirpath-object-string-class-shiori-shiories-"><code>Promise&lt;Shiori|null&gt;</code> (function)(<code>FileSystemLike</code> fs, <code>string</code> dirpath, <code>Object&lt;string, class Shiori&gt;</code> shiories)</h3>
<ul>
<li>fs: node.jsのFile Systemか、BrowserFSのファイルシステム。</li>
<li>dirpath: SHIORI/2.x, SHIORI/3.x <code>load()</code>に渡されるものと同じ<code>ghost/master</code>へのフルパス。末尾は必ずパスセパレータ(<code>\</code>,<code>/</code>等 環境依存)。</li>
<li>shiories: 栞名と対応する栞クラスの連想配列。</li>
</ul><p>fsとdirpathの情報から栞を判定し、shioriesから該当する栞クラスを選んでそのインスタンスを返してください。</p><p>栞が判定できなかった場合、nullを返してください。</p><p>栞が判定できたがロードできなかった場合、例外を発生してください。</p><h2 id="references">References</h2>
<ul>
<li>栞判定関数 <a href="https://github.com/Ikagaka/shioridetector-common_names">shioridetector-common_names</a></li>
<li>栞クラス <a href="https://github.com/Narazaka/kawariworker.js">kawariworker.js</a></li>
</ul>
<h2 id="license">License</h2><p>This is released under <a href="http://narazaka.net/license/MIT?2015">MIT License</a>.</p>
      </div>
    </div>
    <div id='footer'>
  May 23, 15 11:21:10 by
  <a href='https://github.com/coffeedoc/codo' title='CoffeeScript API documentation generator'>
    Codo
  </a>
  2.0.11
  &#10034;
  Press H to see the keyboard shortcuts
  &#10034;
  <a href='http://twitter.com/netzpirat' target='_parent'>@netzpirat</a>
  &#10034;
  <a href='http://twitter.com/_inossidabile' target='_parent'>@_inossidabile</a>
</div>
<iframe id='search_frame'></iframe>
<div id='fuzzySearch'>
  <input type='text'>
  <ol></ol>
</div>
<div id='help'>
  <p>
    Quickly fuzzy find classes, mixins, methods, file:
  </p>
  <ul>
    <li>
      <span>T</span>
      Open fuzzy finder dialog
    </li>
  </ul>
  <p>
    Control the navigation frame:
  </p>
  <ul>
    <li>
      <span>L</span>
      Toggle list view
    </li>
    <li>
      <span>C</span>
      Show class list
    </li>
    <li>
      <span>I</span>
      Show mixin list
    </li>
    <li>
      <span>F</span>
      Show file list
    </li>
    <li>
      <span>M</span>
      Show method list
    </li>
    <li>
      <span>E</span>
      Show extras list
    </li>
  </ul>
  <p>
    You can focus and blur the search input:
  </p>
  <ul>
    <li>
      <span>S</span>
      Focus search input
    </li>
    <li>
      <span>Esc</span>
      Blur search input
    </li>
  </ul>
</div>
  </body>
</html>