<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>shioriloader</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script src="assets/js/modernizr.js"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.js" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">shioriloader</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1> shioriloader</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<h1 id="shioriloader">ShioriLoader</h1>
				<p>伺かの栞サブシステムをロードします。</p>
				<h2 id="-">使用方法</h2>
				<pre><code>&lt;script src=<span class="hljs-string">"ShioriLoader.js"</span>&gt;&lt;/script&gt;
&lt;script src=<span class="hljs-string">"shioridetector-common_names.js"</span>&gt;&lt;/script&gt;
&lt;script src=<span class="hljs-string">"kawariworker.js"</span>&gt;&lt;/script&gt;

<span class="hljs-keyword">var</span> <span class="hljs-type">ShioriLoader</span> = shioriLoader.<span class="hljs-type">ShioriLoader</span>;
<span class="hljs-type">ShioriLoader</span>.shioriDetectors.push(function()<span class="hljs-meta">{...}</span>); // 追加の栞判定関数登録
<span class="hljs-type">ShioriLoader</span>.shioriDetectors.push(function()<span class="hljs-meta">{...}</span>);
// shioridetector-common_names.jsなど栞判定関数ライブラリを読み込めば自動的に登録されている。

<span class="hljs-type">ShioriLoader</span>.shiories.myshiori = function()<span class="hljs-meta">{...}</span>; // 追加の栞クラス登録
<span class="hljs-type">ShioriLoader</span>.shiories.satori = function()<span class="hljs-meta">{...}</span>;
// kawariworker.jsなど栞ライブラリを読み込めば自動的に登録されている。

<span class="hljs-type">ShioriLoader</span>.detectShiori().then(function(shiori){
  shiori.load(dirpath).then(...);
}, function(error){
  throw error;
});
</code></pre><p>やりとりをすべて非同期で行うため、すべてのメソッドは<code>Promise</code>を返します。</p>
				<h2 id="class-shioriloader">class ShioriLoader</h2>
				<p>栞サブシステムをロードするSingletonクラスです。</p>
				<h3 id="-array-shioridetector-shioridetectors-static-"><code>Array&lt;ShioriDetector&gt;</code> shioriDetectors <em>static</em></h3>
				<pre><code><span class="hljs-type">ShioriLoader</span>.shioriDetectors.push(function()<span class="hljs-meta">{...}</span>);
</code></pre><p>栞判定関数の配列です。</p>
				<h3 id="-object-string-class-shiori-shiories-static-"><code>Object&lt;string, class Shiori&gt;</code> shiories <em>static</em></h3>
				<pre><code><span class="hljs-keyword">ShioriLoader.shiories.myshiori </span>= myshioriClass<span class="hljs-comment">;</span>
</code></pre><p>栞名と栞クラスの連想配列です。</p>
				<h3 id="-promise-shiori-detectshiori-filesystemlike-fs-string-dirpath-static-"><code>Promise&lt;Shiori&gt;</code> detectShiori(<code>FileSystemLike</code> fs, <code>string</code> dirpath) <em>static</em></h3>
				<pre><code>var dirpath = <span class="hljs-string">'./ikagaka/ghost/myghost/ghost/master/'</span>;
ShioriLoader.detectShiori(fs, dirpath).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(shiori)</span></span>{
  shiori.<span class="hljs-built_in">load</span>(dirpath).<span class="hljs-keyword">then</span>(...);
}, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span></span>{
  throw <span class="hljs-built_in">error</span>;
});
</code></pre><ul>
					<li>fs: node.jsのFile Systemか、BrowserFSのファイルシステム。</li>
					<li>dirpath: SHIORI/2.x, SHIORI/3.x <code>load()</code>に渡されるものと同じ<code>ghost/master</code>へのフルパス。末尾は必ずパスセパレータ(<code>\</code>,<code>/</code>等 環境依存)。</li>
				</ul>
				<p>登録された栞判定関数を順番に実行します。</p>
				<p>栞判定関数が返した栞インスタンスを返します。</p>
				<p>栞判定関数が<code>null</code>を返せば次の栞判定関数を実行します。</p>
				<p>すべての栞判定関数が栞インスタンスを返さなければ例外を発生します。</p>
				<h3 id="-promise-shiori-getshiori-filesystemlike-fs-string-shiori_name-static-"><code>Promise&lt;Shiori&gt;</code> getShiori(<code>FileSystemLike</code> fs, <code>string</code> shiori_name) <em>static</em></h3>
				<pre><code>var dirpath = <span class="hljs-string">'./ikagaka/ghost/myghost/ghost/master/'</span>;
ShioriLoader.getShiori(fs, <span class="hljs-string">'kawari'</span>).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(shiori)</span></span>{
  shiori.<span class="hljs-built_in">load</span>(dirpath).<span class="hljs-keyword">then</span>(...);
}, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span></span>{
  throw <span class="hljs-built_in">error</span>;
});
</code></pre><ul>
					<li>fs: node.jsのFile Systemか、BrowserFSのファイルシステム。</li>
					<li>shiori_name: shioriesに登録された栞名</li>
				</ul>
				<p>指定された栞のインスタンスを返します。</p>
				<p>失敗すれば例外を発生します。</p>
				<h2 id="interface-shiori">interface Shiori</h2>
				<p>SHIORI/2.x, SHIORI/3.x規格に準拠した栞サブシステムのインターフェースです。</p>
				<p>登録される栞は以下のAPIに準拠するべきです。</p>
				<h3 id="constructor-filesystemlike-fs-">constructor(<code>FileSystemLike</code> fs)</h3>
				<ul>
					<li>fs: node.jsのFile Systemか、BrowserFSのファイルシステム。</li>
				</ul>
				<p>ゴーストのファイルを扱うインターフェースとしてfsが渡されます。</p>
				<p>node.jsである場合とbrowserfsである場合があります。</p>
				<h3 id="-promise-int-load-string-dirpath-"><code>Promise&lt;int&gt;</code> load(<code>string</code> dirpath)</h3>
				<ul>
					<li>dirpath: SHIORI/2.x, SHIORI/3.x <code>load()</code>に渡されるものと同じ<code>ghost/master</code>へのフルパス。末尾は必ずパスセパレータ(<code>\</code>,<code>/</code>等 環境依存)。</li>
				</ul>
				<p>SHIORI/2.x, SHIORI/3.x <code>load()</code>です。</p>
				<p><code>load()</code>の戻り値を返してください。</p>
				<h3 id="-promise-string-request-string-request-"><code>Promise&lt;string&gt;</code> request(<code>string</code> request)</h3>
				<ul>
					<li>dirpath: SHIORI/2.x, SHIORI/3.x <code>request()</code>に渡されるものと同じSHIORI/2.x, SHIORI/3.x Request。</li>
				</ul>
				<p>SHIORI/2.x, SHIORI/3.x <code>request()</code>です。</p>
				<p>SHIORI/2.x, SHIORI/3.x Responseを返してください。</p>
				<h3 id="-promise-int-unload-"><code>Promise&lt;int&gt;</code> unload()</h3>
				<p>SHIORI/2.x, SHIORI/3.x <code>unload()</code>です。</p>
				<p><code>unload()</code>の戻り値を返してください。</p>
				<h2 id="interface-shioridetector">interface ShioriDetector</h2>
				<p>栞を判定し、ロードする関数のインターフェースです。</p>
				<p>登録される栞判定関数は以下のAPIに準拠するべきです。</p>
				<h3 id="-promise-shiori-null-function-filesystemlike-fs-string-dirpath-object-string-class-shiori-shiories-"><code>Promise&lt;Shiori|null&gt;</code> (function)(<code>FileSystemLike</code> fs, <code>string</code> dirpath, <code>Object&lt;string, class Shiori&gt;</code> shiories)</h3>
				<ul>
					<li>fs: node.jsのFile Systemか、BrowserFSのファイルシステム。</li>
					<li>dirpath: SHIORI/2.x, SHIORI/3.x <code>load()</code>に渡されるものと同じ<code>ghost/master</code>へのフルパス。末尾は必ずパスセパレータ(<code>\</code>,<code>/</code>等 環境依存)。</li>
					<li>shiories: 栞名と対応する栞クラスの連想配列。</li>
				</ul>
				<p>fsとdirpathの情報から栞を判定し、shioriesから該当する栞クラスを選んでそのインスタンスを返してください。</p>
				<p>栞が判定できなかった場合、nullを返してください。</p>
				<p>栞が判定できたがロードできなかった場合、例外を発生してください。</p>
				<h2 id="api-documents">API Documents</h2>
				<p><a href="https://ikagaka.github.io/ShioriLoader">API Documents</a></p>
				<h2 id="references">References</h2>
				<ul>
					<li>栞判定関数 <a href="https://github.com/Ikagaka/shioridetector-common_names">shioridetector-common_names</a></li>
					<li>栞クラス <a href="https://github.com/Narazaka/kawariworker.js">kawariworker.js</a></li>
				</ul>
				<h2 id="license">License</h2>
				<p>This is released under <a href="http://narazaka.net/license/MIT?2015">MIT License</a>.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_shiori_loader_.html">"shiori-<wbr>loader"</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="http://typedoc.io" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>